---
layout: post
title:  "SQL基础学习笔记"
tags:   [SQL]
date:   2021-03-15 14:36:43
categories: [笔记]
---
# 遇到的问题

1. nothing

# 简单的操作

### 1. 在cmd运行MySQL  
`mysql -uroot -p123456`

### 2. 在cmd上退出MySQL  
`exit`

### 3. 在cmd上停止MySQL服务（必须具备管理员权限）  
`net stop mysql`

### 4. 在cmd上开始MySQL服务（必须具备管理员权限）  
`net start mysql`

### 5. 在cmd上查看MySQL的版本  
`mysql --version`
`mysql -V`

### 6. 创建数据库  
`create database db_test;`

### 7. 删除数据库  
`drop database db_test;`

### 8. 导入.sql脚本文件  
`source c:\db_test.sql;`

### 9. 显示数据库  
`show databases;`

### 10. 使用数据库  
`use db_test;`

### 11. 在MySQL中查看版本  
`select version();`

### 12. 查看当前正在使用的数据库  
`select database();`

### 13. 终止正在编写的语句  
`\c`

### 14. 查看数据库里面的表  
`show tables;`    

### 15. 查看其他数据库中的表  
`show tables from [databasename];`

### 16. 查看表结构  
`desc [tablename];`

### 17. 查看表的创建语句  
`show create table [tablename];`

### 18. 查询全部字段，但不建议用*，建议写明字段，提高可读性  
`select * from emp;`

### 19. 查询一个字段
- 如：员工姓名  
`select ename from emp;`

### 20. 查询多个字段
- 如：编号和姓名  
`select empno,ename from emp;`

### 21. 运算符
- 如：计算一年的薪水  
`select ename,sal * 12 from emp;`

### 22. 字段改名显示，用as
- 如：把编号和名字的字段改名显示  
`select empno as no,ename as name from emp;`

# 条件查询 where

### 23. =
- 如：查询薪水为5000的员工名  
`select ename,sal from emp where sal = 5000;`
- 如：查询字符串的时候要加""或''，Windows平台下的MySQL对大小写不敏感  
`select ename,job from emp where job = 'MANAGER';`

### 24. <>，!=
- 如：查询薪水不是5000的员工名  
`select ename,sal from emp where sal <>= 5000;`

### 25. between...and...
- 如：查询薪水在[1600~3000]范围的员工名  
`select ename,sal from emp where sal between 1600 and 3000;`
- 如：和以下语句效果一致  
`select ename,sal from emp where sal >=1600 and sal <=3000;`

### 26. null,必须配合is一起使用
- 如：查询没有补助的员工名  
`select ename,comm from emp where comm is null;`

### 27. 条件查询，and
- 如：查询职位是MANAGER，而且薪水在2500以上的员工名  
`select ename,job,sal from emp where job = 'MANAGER' and sal > 2500;`

### 28. or
- 如：查询职位是MANAGER或者是SALESMAN的员工名  
`select ename,job from emp where job = 'MANAGER' or job = 'SALESMAN';`

### 29. in，在枚举范围内查询
- 如：上例，可以改成  
`select ename,job from emp where job in('MANAGER','SALESMAN');`
- 如：in三个数值，就只有等于这三个值的项才会被找出，in不是范围  
`select ename,sal from emp where sal in (1250,3000,5000);`

### 30. not，剔除条件项留下其他项
- 如：薪水不是1600和3000的员工名  
`select ename,sal from emp where not(sal=1600 or sal=3000);`
- 如：效果和以下语句一致  
`select ename,sal from emp where sal <> 1600 and sal <> 3000;`
`select ename,sal from emp where sal not in (1600,3000);`

### 31. like % _  ，%匹配任意个数字符，_匹配一个字符
- 如：查询名字为'M'开头的所工名  
`select ename from emp where ename like 'M%';`
- 如：查询名字为'N'结尾的员工名  
`select ename from emp where ename like '%N';`
- 如：查询名字为包含'O'的所有员工名  
`select ename from emp where ename like '%O%';`
- 如：查询名字为第二个字是'A'员工名  
`select ename from emp where ename like '_A%';`

# 结果排序 order by

### 32. 默认从小到大
- 如：查询薪水，以默认方式按照薪水排序  
`select sal from emp order by sal;`

### 33. where + order by，order by必须放where的后面
- 如：查询职位是MANAGER的薪水，以默认方式按照薪水排序  
`select job,sal from emp where job='MANAGER' order by sal;`

### 34. 按照多个字段排序
- 如：先按照job排序，再按照sal排序  
`select job,sal from emp order by job,sal;`

### 35. 手动指定排序顺序，asc从小到大，desc从大到小
- 如：查询薪水，从小到大排序  
`select sal from emp order by sal asc;`
- 如：查询薪水，从大到小排序  
`select sal from emp order by sal desc;`

### 36. 多个字段手动排序
- 如：按照职位从大到小排，薪水从小到大排  
`select job,sal from emp order by job desc,sal asc;`

# 数据处理函数 / 单行处理函数

### 37. lower()，转小写
- 如：把员工名转小写  
`select lower(ename) from emp;`

### 38. upper()，转小写
- 如：查询职位是MANAGER的员工名，把manager转大写  
`select ename from emp where job = upper('manager');`

### 39. substr(field,index,length)，截取，第一位是1
- 如：查询第一个字母是M的员工名字  
`select ename from emp where substr(ename,1,1)='M';`

### 40. length(field)，字段长度
- 如：查询长度为5的员工名  
`select ename from emp where length(ename)=5;`

### 41. trim(' '),去掉首尾空格，不会取出中间格
- 如：查询职位为'MANAGER '的员工名  
`select ename from emp where job=trim('MANAGER ');`

### 42. str_to_date('字符串','匹配格式')，年为大写Y
- 如：查询'11-17-1981'入社的员工名  
`select ename,hiredate from emp where hiredate=str_to_date('11-17-1981','%m-%d-%Y');`

### 43. date_format('field','%Y-%m-%d %H:%i:%s')，把字段格式转换为指定格式  
- 如：查询1985年1月1日之后入职的员工信息，并把入职时间格式化为%Y-%m-%d %H:%i:%s  
`select empno as no, ename as name, date_format(hiredate,'%H-%m-%d %H-%i-%s') as hiredate from emp where hiredate > '1985-01-01';`

### 44. date_format(now(),'%Y-%m-%d %H:%i:%s')),获取当前系统时间  
- %H——4位年份
- %h——2位年份
- %M——月份，January，February...December
- %m——月份，01，02...12
- %c——月份，1，2...12
- %D——日期，1st，2nd...31st
- %d——日期，01，02...31
- %H——小时，00，01...23
- %h——小时，00，01...12
- %i——分钟，00，01...59
- %s——秒数，00，01...59
- %r——12小时，hh:mm:ss AM
- %T——24小时，hh:mm:ss
- 如：查询现在的系统时间，格式是：YY-MM-dd hh:mm:ss来显示
`select date_format(now(),'%Y-%m-%d %T') as date;`

### 45. format('field','dateType'),格式转换  
- 如：查询员工薪水，结果添加千分位  
`select empno,ename,format(sal,'$1,111') as sal from emp;`
- 如：查询员工薪水，结果添加千分位，两位小数  
`select empno,ename,format(sal,2) as sal from emp;`  

### 46. round(数字,保留小数点后几位),四舍五入
- 如：123.6，四舍五入后取整  
`select round(123.6);`
- 如：123.567，四舍五入小数点保留一位  
`select round(123.567,1);`

### 47. rand()，0到1之间的随机数
- 如：生成0到99间的随机数  
`select 100 * rand();`
- 如：生成0到99间的随机整数  
`select round(100*rand());`
- 如：随机抽取记录数  
`select * from emp order by rand() limit 2;`

### 48. case 字段 when 等于值1 then 执行操作1 when 等于值2 then 执行操作2 else 其他情况时，执行的操作 end
- 如：职位是MANAGER的员工薪水提升1倍，职位是SALESMAN的员工薪水提升0.5倍    
`select ename,job,sal,case job when 'MANAGER' then sal*2 when 'SALESMAN' then sal*1.5 end as new_sal from emp;`
- 以上结果对于其他薪水没有变化的项，在new_sal列里会显示为NULL，若想填入原来结果，需加else  
`select ename,job,sal,case job when 'MANAGER' then sal*2 when 'SALESMAN' then sal*1.5 else sal end as new_sal from emp;`

### 49. ifnull(field,0),如果字段的值是NULL，就用0来代替
- 如：计算包含每月奖金的全年收入  
`select ename,sal,comm,(sal+ifnull(comm,0))*12 as yearsal from emp;`

# 分组处理函数 / 多行处理函数（不能用在where后）

### 50. count(field),计算数量
- 如：取得记录条数（表中行数，因为插入行时始终有一列会有数据）  
`select count(*) from emp;`

- 如：取津贴不为NULL的员工数（自动忽略NULL项）  
`select count(comm) from emp;`

- 如：取得工作岗位数  
`select count(job) from emp;`

- 但以上查询结果是所有非NULL项的数量，如果要忽略重复项，需要加上distinct  
`select count(distinct job) from emp;`

### 51. sum(field),取得某一列的和，NULL会被忽略
- 如：取得所有员工每月工资的总和  
`select sum(sal) as sals from emp;`

- 如：取得所有员工每月津贴的总和  
`select sum(comm) as comms from emp;`

- 如：取得每月工资和津贴的总和  
`select sum(sal+ifnull(comm,0)) as 'sal+comm' from emp;`

### 52. avg(field),取得某一列的平均值
- 如：取得平均工资  
`select avg(sal) as 'avg of sal' from emp;`

### 53. max(field),取得某一列中的最大值
- 如：取得最高工资  
`select max(sal) as 'max of sal' from emp;`

### 53. min(field),取得某一列中的最小值
- 如：取得最低工资  
`select min(sal) as 'min of sal' from emp;`

- 如：取得最早入职的员工的入职时间  
`select min(hiredate) as 'old of hiredate' from emp;`

### 54. 组合聚合函数，把上述分组处理函数放在select一起使用
- 如：计算薪水的数量，总值，平均值，最大值，最小值  
```
select
    count(sal) as 'SalCount',
    sum(sal) as 'SalSum',
    avg(sal) as 'SalAvg',
    max(sal) as 'SalMax',
    min(sal) as 'SalMin'
from
    emp;       
```












# 34道练习题

1. 取得每个部门的最高薪水的人员名称。
- 期望结果
